---
- name: manage_service.yaml / Stop Galactica service on workers
  become: yes
  become_user: root
  service:
    name: indeximas
    daemon_reload: yes
    state: stopped
  tags: [ 'never', 'grestart', 'gstop', 'istop', 'stop']
  when:
    - is_master == 0
    - ha == 0

- name: manage_service.yaml / Stop Galactica service on master
  become: yes
  become_user: root
  service:
    name: indeximam
    daemon_reload: yes
    state: stopped
  tags: [ 'never', 'grestart', 'gstop', 'istop', 'stop']
  when:
    - is_master == 1
    - ha == 0

# HA
- name: manage_service.yaml / Stop Galactica service on ha cluster
  become: yes
  become_user: root
  service:
    name: indexima
    daemon_reload: yes
    state: stopped
  tags: [ 'never', 'grestart', 'gstop', 'istop', 'stop']
  when: ha == 1

# VD 2
- name: manage_service.yaml / Stop Visualdoop service
  become: yes
  become_user: root
  service:
    name: visualdoop
    daemon_reload: yes
    state: stopped
  tags: [ 'never', 'vrestart', 'vstop', 'istop', 'stop']
  when:
    - is_master == 1

# Standard
- name: manage_service.yaml / Enable Galactica service on workers
  become: yes
  become_user: root
  service:
    name: indeximas
    daemon_reload: yes
    enabled: yes
  tags: [ 'grestart', 'gstart', 'istart', 'start']
  when:
    - is_master == 0
    - ha == 0

- name: manage_service.yaml / Start Galactica service on workers
  become: yes
  become_user: root
  service:
    name: indeximas
    daemon_reload: yes
    state: started
  tags: [ 'grestart', 'gstart', 'istart', 'start']
  when:
    - is_master == 0
    - ha == 0

- name: manage_service.yaml / Enable Galactica service on master
  become: yes
  become_user: root
  service:
    name: indeximam
    daemon_reload: yes
    enabled: yes
  tags: [ 'grestart', 'gstart', 'istart', 'start']
  when:
    - is_master == 1
    - ha == 0

- name: manage_service.yaml / Start Galactica service on master
  become: yes
  become_user: root
  service:
    name: indeximam
    daemon_reload: yes
    state: started
  tags: [ 'grestart', 'gstart', 'istart', 'start']
  when:
    - is_master == 1
    - ha == 0

# HA
- name: manage_service.yaml / Enable Galactica service on ha cluster
  become: yes
  become_user: root
  service:
    name: indexima
    daemon_reload: yes
    enabled: yes
  tags: [ 'grestart', 'gstart', 'istart', 'start']
  when: ha == 1

- name: manage_service.yaml / Start Galactica service on ha cluster
  become: yes
  become_user: root
  service:
    name: indexima
    daemon_reload: yes
    state: started
  tags: [ 'grestart', 'gstart', 'istart', 'start']
  when: ha == 1

# VD2
- name: manage_service.yaml / Enable Visualdoop service
  become: yes
  become_user: root
  service:
    name: visualdoop
    daemon_reload: yes
    enabled: yes
  tags: [ 'vrestart', 'vstart', 'istart', 'start']
  when:
    - is_master == 1

- name: manage_service.yaml / Start Visualdoop service
  become: yes
  become_user: root
  service:
    name: visualdoop
    daemon_reload: yes
    state: started
  tags: [ 'vrestart', 'vstart', 'istart', 'start']
  when:
    - is_master == 1
